<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <title>Meme Meter - All Solana Tokens Scanner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --green: #00ff00;
            --red: #ff0055;
            --yellow: #ffc800;
            --blue: #00aaff;
            --purple: #aa00ff;
            --bg-primary: #000;
            --bg-secondary: #0a0a0a;
            --border: rgba(255, 255, 255, 0.05);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', system-ui, sans-serif;
            background: var(--bg-primary);
            color: #fff;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }
        
        /* Header */
        .header {
            background: rgba(0, 0, 0, 0.98);
            backdrop-filter: blur(30px);
            border-bottom: 1px solid var(--border);
            padding: 16px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.4);
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }
        
        .logo-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo {
            font-size: 32px;
            font-weight: 900;
            color: var(--green);
            font-family: 'Monaco', 'Courier New', monospace;
            text-shadow: 0 0 30px rgba(0, 255, 0, 0.5);
            letter-spacing: -2px;
        }
        
        .brand-name {
            font-size: 24px;
            font-weight: 900;
            letter-spacing: -0.5px;
        }
        
        .brand-tagline {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
            font-weight: 700;
            margin-top: 2px;
        }
        
        .status-bar {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.6);
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #666;
            transition: all 0.3s;
        }
        
        .status-dot.active {
            background: var(--green);
            box-shadow: 0 0 16px rgba(0, 255, 0, 0.8);
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.2); }
        }
        
        /* Stats Bar */
        .stats-bar {
            background: linear-gradient(135deg, rgba(255, 0, 85, 0.08) 0%, rgba(0, 0, 0, 0.6) 100%);
            border-bottom: 1px solid rgba(255, 0, 85, 0.15);
            padding: 16px 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 16px;
        }
        
        .stat {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .stat-value {
            font-size: 22px;
            font-weight: 900;
            font-family: 'Monaco', monospace;
            color: var(--green);
            text-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }
        
        .stat-label {
            font-size: 10px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Filter Tabs */
        .filter-tabs {
            display: flex;
            gap: 8px;
            padding: 16px 20px;
            overflow-x: auto;
            scrollbar-width: none;
            background: rgba(0, 0, 0, 0.6);
            border-bottom: 1px solid var(--border);
        }
        
        .filter-tabs::-webkit-scrollbar { display: none; }
        
        .filter-tab {
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 700;
            background: rgba(255, 255, 255, 0.03);
            color: rgba(255, 255, 255, 0.6);
            border: 1px solid transparent;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s;
        }
        
        .filter-tab:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .filter-tab.active {
            background: var(--green);
            color: #000;
            border-color: var(--green);
            box-shadow: 0 4px 16px rgba(0, 255, 0, 0.3);
        }
        
        /* Container */
        .container {
            padding: 0 0 100px 0;
            min-height: calc(100vh - 300px);
        }
        
        /* Token List */
        .token-list {
            display: flex;
            flex-direction: column;
        }
        
        .token-card {
            background: linear-gradient(135deg, rgba(15, 15, 15, 0.95) 0%, rgba(8, 8, 8, 0.95) 100%);
            border-bottom: 1px solid var(--border);
            padding: 16px 20px;
            display: flex;
            align-items: center;
            gap: 14px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        
        .token-card:hover {
            background: rgba(20, 20, 20, 0.95);
        }
        
        .token-card.new {
            animation: tokenAppear 0.5s ease;
        }
        
        @keyframes tokenAppear {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .token-icon {
            width: 52px;
            height: 52px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00ff88 0%, #00cc66 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 900;
            color: #000;
            flex-shrink: 0;
            box-shadow: 0 4px 16px rgba(0, 255, 136, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .token-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        
        .token-icon.danger {
            background: linear-gradient(135deg, var(--red) 0%, #cc0044 100%);
            color: #fff;
            box-shadow: 0 4px 16px rgba(255, 0, 85, 0.3);
        }
        
        .token-icon.medium {
            background: linear-gradient(135deg, var(--yellow) 0%, #cc9900 100%);
            color: #000;
            box-shadow: 0 4px 16px rgba(255, 200, 0, 0.3);
        }
        
        .platform-badge {
            position: absolute;
            bottom: -2px;
            right: -2px;
            background: #000;
            border: 2px solid #000;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }
        
        .token-info {
            flex: 1;
            min-width: 0;
        }
        
        .token-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }
        
        .token-name {
            font-size: 17px;
            font-weight: 900;
            letter-spacing: -0.3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .token-symbol {
            font-size: 13px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.5);
            font-family: 'Monaco', monospace;
        }
        
        .dex-badge {
            font-size: 10px;
            font-weight: 900;
            padding: 2px 8px;
            border-radius: 6px;
            background: rgba(0, 170, 255, 0.15);
            color: var(--blue);
            border: 1px solid rgba(0, 170, 255, 0.3);
        }
        
        .token-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 12px;
            font-weight: 700;
            flex-wrap: wrap;
        }
        
        .token-price {
            color: var(--green);
            font-family: 'Monaco', monospace;
        }
        
        .token-liquidity {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .token-volume {
            color: rgba(255, 255, 255, 0.5);
        }
        
        /* Risk Badge */
        .risk-badge {
            padding: 10px 16px;
            border-radius: 14px;
            font-size: 20px;
            font-weight: 900;
            font-family: 'Monaco', monospace;
            line-height: 1;
            flex-shrink: 0;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .risk-safe {
            background: rgba(0, 255, 136, 0.15);
            color: #00ff88;
            border: 2px solid rgba(0, 255, 136, 0.4);
        }
        
        .risk-medium {
            background: rgba(255, 200, 0, 0.15);
            color: var(--yellow);
            border: 2px solid rgba(255, 200, 0, 0.4);
        }
        
        .risk-high {
            background: rgba(255, 0, 85, 0.15);
            color: var(--red);
            border: 2px solid rgba(255, 0, 85, 0.4);
            box-shadow: 0 0 24px rgba(255, 0, 85, 0.2);
        }
        
        /* Loading */
        .loading {
            padding: 60px 20px;
            text-align: center;
        }
        
        .spinner {
            width: 48px;
            height: 48px;
            border: 4px solid rgba(0, 255, 0, 0.1);
            border-top-color: var(--green);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 700;
        }
        
        /* Toast */
        .toast {
            position: fixed;
            top: 80px;
            right: 20px;
            background: linear-gradient(135deg, var(--green) 0%, #00dd88 100%);
            color: #000;
            padding: 14px 20px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 900;
            box-shadow: 0 8px 32px rgba(0, 255, 0, 0.4);
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 1000;
            max-width: calc(100% - 40px);
        }
        
        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }
        
        /* Bottom Bar */
        .bottom-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.98);
            backdrop-filter: blur(30px);
            border-top: 1px solid var(--border);
            padding: 12px 20px;
            display: flex;
            justify-content: space-around;
            z-index: 100;
            box-shadow: 0 -4px 24px rgba(0, 0, 0, 0.4);
        }
        
        .bottom-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            font-size: 24px;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 12px;
            transition: all 0.2s;
        }
        
        .bottom-btn.active {
            color: var(--green);
            background: rgba(0, 255, 0, 0.05);
        }
        
        .bottom-btn-label {
            font-size: 10px;
            font-weight: 700;
        }
        
        /* Disclaimer */
        .disclaimer {
            background: rgba(255, 170, 0, 0.08);
            border: 1px solid rgba(255, 170, 0, 0.2);
            border-radius: 12px;
            padding: 16px 20px;
            margin: 20px;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.6;
        }
        
        .disclaimer-title {
            color: #ffaa00;
            font-weight: 900;
            margin-bottom: 8px;
            font-size: 12px;
        }
        
        /* Error Banner */
        .error-banner {
            background: rgba(255, 0, 85, 0.1);
            border: 1px solid rgba(255, 0, 85, 0.3);
            border-radius: 12px;
            padding: 16px 20px;
            margin: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .error-message {
            flex: 1;
            font-size: 13px;
            font-weight: 700;
            color: var(--red);
        }
        
        .retry-btn {
            background: var(--red);
            color: #fff;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 900;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="logo-section">
            <div class="logo-group">
                <div>
                    <div class="logo">MM</div>
                </div>
                <div>
                    <div class="brand-name">Meme Meter</div>
                    <div class="brand-tagline">All Solana Tokens</div>
                </div>
            </div>
        </div>
        <div class="status-bar">
            <div class="status-item">
                <div class="status-dot" id="wsStatus"></div>
                <span id="wsText">Connecting...</span>
            </div>
            <div class="status-item">
                <span id="tokenCount">0 tokens</span>
            </div>
            <div class="status-item">
                <span id="updateTime">--</span>
            </div>
        </div>
    </div>

    <!-- Stats Bar -->
    <div class="stats-bar">
        <div class="stat">
            <div class="stat-value" id="statScanned">0</div>
            <div class="stat-label">Total</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="statRugs" style="color: var(--red);">0</div>
            <div class="stat-label">High Risk</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="statMedium" style="color: var(--yellow);">0</div>
            <div class="stat-label">Caution</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="statSafe" style="color: #00ff88;">0</div>
            <div class="stat-label">Safe</div>
        </div>
    </div>

    <!-- Filter Tabs -->
    <div class="filter-tabs">
        <button class="filter-tab active" data-filter="all">All Tokens</button>
        <button class="filter-tab" data-filter="new">üî• New (24h)</button>
        <button class="filter-tab" data-filter="safe">‚úÖ Safe</button>
        <button class="filter-tab" data-filter="medium">‚ö†Ô∏è Caution</button>
        <button class="filter-tab" data-filter="danger">üö® High Risk</button>
        <button class="filter-tab" data-filter="raydium">Raydium</button>
        <button class="filter-tab" data-filter="orca">Orca</button>
        <button class="filter-tab" data-filter="pump">Pump.fun</button>
    </div>

    <!-- Container -->
    <div class="container">
        <!-- Disclaimer -->
        <div class="disclaimer">
            <div class="disclaimer-title">‚ö†Ô∏è DISCLAIMER</div>
            Educational tool only. Not financial advice. Risk scores may be inaccurate. Always DYOR. You can lose all your money. We are not liable for losses.
        </div>

        <div class="token-list" id="tokenList">
            <div class="loading">
                <div class="spinner"></div>
                <div class="loading-text">Scanning Solana blockchain...</div>
            </div>
        </div>
    </div>

    <!-- Bottom Bar -->
    <div class="bottom-bar">
        <button class="bottom-btn active">
            <span>üìä</span>
            <span class="bottom-btn-label">Tokens</span>
        </button>
        <button class="bottom-btn" onclick="window.open('https://twitter.com/mememeterapp', '_blank')">
            <span>üê¶</span>
            <span class="bottom-btn-label">Twitter</span>
        </button>
        <button class="bottom-btn">
            <span>üìà</span>
            <span class="bottom-btn-label">Stats</span>
        </button>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
        
        const CONFIG = {
            HELIUS_API_KEY: '3b625ec8-4be8-4348-b8dd-43addf34330c',
            DEXSCREENER_API: 'https://api.dexscreener.com/latest/dex/tokens',
            DEXSCREENER_PAIRS: 'https://api.dexscreener.com/latest/dex/pairs/solana',
            REFRESH_INTERVAL: 30000, // 30 seconds
            MAX_TOKENS: 100
        };

        // ============================================
        // STATE MANAGEMENT
        // ============================================
        
        let tokens = [];
        let currentFilter = 'all';
        let lastUpdate = Date.now();

        // ============================================
        // INITIALIZATION
        // ============================================
        
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ Meme Meter - All Solana Tokens Edition');
            setupEventListeners();
            startFetching();
            setupUpdateTimer();
        });

        function setupEventListeners() {
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                    e.target.classList.add('active');
                    currentFilter = e.target.dataset.filter;
                    renderTokens();
                });
            });
        }

        // ============================================
        // DATA FETCHING
        // ============================================
        
        function startFetching() {
            fetchAllSolanaTokens();
            setInterval(fetchAllSolanaTokens, CONFIG.REFRESH_INTERVAL);
        }

        async function fetchAllSolanaTokens() {
            console.log('üì° Fetching ALL Solana tokens...');
            updateStatus('active', 'Scanning...');

            try {
                // Fetch from DexScreener - gets ALL Solana pairs
                const response = await fetch('https://api.dexscreener.com/latest/dex/search?q=SOL');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();
                console.log(`‚úÖ Got ${data.pairs?.length || 0} pairs`);

                if (data.pairs && data.pairs.length > 0) {
                    // Filter for Solana only
                    const solanaPairs = data.pairs.filter(p => p.chainId === 'solana');
                    processTokensData(solanaPairs);
                    updateStatus('active', 'Live');
                    lastUpdate = Date.now();
                } else {
                    throw new Error('No pairs returned');
                }

            } catch (error) {
                console.error('‚ùå Fetch error:', error);
                updateStatus('error', 'Error');
                showError('Failed to fetch tokens. Retrying...');
                
                // Load demo as fallback
                if (tokens.length === 0) {
                    loadDemoData();
                }
            }
        }

        function processTokensData(pairs) {
            const existingIds = new Set(tokens.map(t => t.address));
            
            tokens = pairs.slice(0, CONFIG.MAX_TOKENS).map((pair, index) => {
                const address = pair.pairAddress || `pair_${index}`;
                const isNew = !existingIds.has(address);
                
                const liquidity = pair.liquidity?.usd || 0;
                const volume24h = pair.volume?.h24 || 0;
                const priceChange = Math.abs(pair.priceChange?.h24 || 0);
                const age = Date.now() - (pair.pairCreatedAt || Date.now());
                
                return {
                    address: address,
                    name: pair.baseToken?.name || 'Unknown',
                    symbol: pair.baseToken?.symbol || 'UNK',
                    price: pair.priceUsd || '0',
                    liquidity: liquidity,
                    volume24h: volume24h,
                    priceChange: pair.priceChange?.h24 || 0,
                    dex: pair.dexId || 'unknown',
                    pairUrl: pair.url || '',
                    createdAt: pair.pairCreatedAt || Date.now(),
                    isNew: isNew,
                    riskScore: calculateRiskScore(liquidity, volume24h, priceChange, age, pair.dexId)
                };
            });

            const newCount = tokens.filter(t => t.isNew).length;
            if (newCount > 0 && existingIds.size > 0) {
                showToast(`üî• ${newCount} new token${newCount > 1 ? 's' : ''} detected!`);
            }

            updateStats();
            renderTokens();
        }

        function calculateRiskScore(liquidity, volume24h, priceChange, age, dexId) {
            let score = 0;
            
            // Liquidity analysis (0-35 points)
            if (liquidity < 1000) score += 35;
            else if (liquidity < 5000) score += 25;
            else if (liquidity < 10000) score += 15;
            else if (liquidity < 50000) score += 5;
            
            // Volume analysis (0-25 points)
            if (volume24h < 100) score += 25;
            else if (volume24h < 1000) score += 15;
            else if (volume24h < 10000) score += 8;
            
            // Price volatility (0-20 points)
            if (priceChange > 100) score += 20;
            else if (priceChange > 50) score += 15;
            else if (priceChange > 20) score += 10;
            
            // Age analysis (0-15 points)
            const ageHours = age / (1000 * 60 * 60);
            if (ageHours < 1) score += 15;
            else if (ageHours < 24) score += 10;
            else if (ageHours < 168) score += 5; // < 1 week
            
            // Platform reputation (0-5 points)
            if (dexId === 'unknown' || dexId === 'pump') score += 5;
            
            return Math.min(100, Math.max(0, score));
        }

        function getRiskLevel(score) {
            if (score >= 75) return 'high';
            if (score >= 40) return 'medium';
            return 'safe';
        }

        function getDexEmoji(dexId) {
            const emojis = {
                'raydium': '‚ö°',
                'orca': 'üêã',
                'pump': 'üî•',
                'meteora': '‚òÑÔ∏è',
                'phoenix': 'üê¶',
                'lifinity': '‚ôæÔ∏è'
            };
            return emojis[dexId] || 'üíé';
        }

        function formatLiquidity(liq) {
            if (liq >= 1000000) return `$${(liq / 1000000).toFixed(2)}M`;
            if (liq >= 1000) return `$${(liq / 1000).toFixed(1)}K`;
            return `$${Math.floor(liq)}`;
        }

        function formatVolume(vol) {
            if (vol >= 1000000) return `${(vol / 1000000).toFixed(2)}M`;
            if (vol >= 1000) return `${(vol / 1000).toFixed(1)}K`;
            return Math.floor(vol);
        }

        // ============================================
        // RENDERING
        // ============================================
        
        function renderTokens() {
            const container = document.getElementById('tokenList');
            const loading = container.querySelector('.loading');
            if (loading) loading.remove();

            let filteredTokens = tokens;
            
            if (currentFilter === 'new') {
                const dayAgo = Date.now() - (24 * 60 * 60 * 1000);
                filteredTokens = tokens.filter(t => t.createdAt > dayAgo);
            } else if (currentFilter === 'safe') {
                filteredTokens = tokens.filter(t => t.riskScore < 40);
            } else if (currentFilter === 'medium') {
                filteredTokens = tokens.filter(t => t.riskScore >= 40 && t.riskScore < 75);
            } else if (currentFilter === 'danger') {
                filteredTokens = tokens.filter(t => t.riskScore >= 75);
            } else if (['raydium', 'orca', 'pump', 'meteora'].includes(currentFilter)) {
                filteredTokens = tokens.filter(t => t.dex.toLowerCase().includes(currentFilter));
            }

            if (filteredTokens.length === 0) {
                container.innerHTML = `
                    <div class="loading">
                        <div style="font-size: 48px; opacity: 0.3;">üîç</div>
                        <div class="loading-text">No tokens found for this filter</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredTokens.map(token => `
                <div class="token-card ${token.isNew ? 'new' : ''}" onclick="window.open('${token.pairUrl}', '_blank')">
                    <div class="token-icon ${getRiskLevel(token.riskScore)}">
                        ${token.symbol.substring(0, 2)}
                        <div class="platform-badge">${getDexEmoji(token.dex)}</div>
                    </div>
                    <div class="token-info">
                        <div class="token-header">
                            <div class="token-name">${escapeHtml(token.name)}</div>
                            <div class="token-symbol">$${token.symbol}</div>
                            <div class="dex-badge">${token.dex.toUpperCase()}</div>
                        </div>
                        <div class="token-meta">
                            <div class="token-price">$${parseFloat(token.price).toFixed(6)}</div>
                            <div class="token-liquidity">Liq: ${formatLiquidity(token.liquidity)}</div>
                            <div class="token-volume">Vol: ${formatVolume(token.volume24h)}</div>
                        </div>
                    </div>
                    <div class="risk-badge risk-${getRiskLevel(token.riskScore)}">
                        ${token.riskScore}
                    </div>
                </div>
            `).join('');

            console.log(`üìä Rendered ${filteredTokens.length} tokens`);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function updateStats() {
            const scanned = tokens.length;
            const high = tokens.filter(t => t.riskScore >= 75).length;
            const medium = tokens.filter(t => t.riskScore >= 40 && t.riskScore < 75).length;
            const safe = tokens.filter(t => t.riskScore < 40).length;

            document.getElementById('tokenCount').textContent = `${scanned} tokens`;
            document.getElementById('statScanned').textContent = scanned;
            document.getElementById('statRugs').textContent = high;
            document.getElementById('statMedium').textContent = medium;
            document.getElementById('statSafe').textContent = safe;
        }

        function updateStatus(status, text) {
            const dot = document.getElementById('wsStatus');
            const statusText = document.getElementById('wsText');
            
            dot.className = 'status-dot ' + (status === 'active' ? 'active' : '');
            statusText.textContent = text;
        }

        function setupUpdateTimer() {
            setInterval(() => {
                const secondsAgo = Math.floor((Date.now() - lastUpdate) / 1000);
                document.getElementById('updateTime').textContent = 
                    secondsAgo < 60 ? `${secondsAgo}s ago` : `${Math.floor(secondsAgo / 60)}m ago`;
            }, 1000);
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 4000);
        }

        function showError(message) {
            const container = document.getElementById('tokenList');
            const existing = container.querySelector('.error-banner');
            if (existing) return;

            container.insertAdjacentHTML('afterbegin', `
                <div class="error-banner">
                    <div class="error-message">${message}</div>
                    <button class="retry-btn" onclick="fetchAllSolanaTokens()">Retry</button>
                </div>
            `);
        }

        function loadDemoData() {
            console.log('üìã Loading demo data...');
            
            const demoPairs = [
                { name: 'Jupiter', symbol: 'JUP', liquidity: 1250000, volume: 3500000, dex: 'raydium', price: 0.85 },
                { name: 'Bonk', symbol: 'BONK', liquidity: 890000, volume: 2100000, dex: 'orca', price: 0.000012 },
                { name: 'Moonshot', symbol: 'MOON', liquidity: 125000, volume: 340000, dex: 'pump', price: 0.0034 },
                { name: 'SafeCoin', symbol: 'SAFE', liquidity: 450000, volume: 780000, dex: 'raydium', price: 1.25 },
                { name: 'RugPull', symbol: 'RUG', liquidity: 4500, volume: 1200, dex: 'pump', price: 0.00001 },
            ];

            tokens = demoPairs.map((pair, index) => ({
                address: `demo_${index}`,
                name: pair.name,
                symbol: pair.symbol,
                price: pair.price.toString(),
                liquidity: pair.liquidity,
                volume24h: pair.volume,
                priceChange: Math.random() * 50 - 25,
                dex: pair.dex,
                pairUrl: '#',
                createdAt: Date.now() - Math.random() * 86400000,
                isNew: false,
                riskScore: calculateRiskScore(pair.liquidity, pair.volume, 10, Date.now() - pair.createdAt, pair.dex)
            }));

            updateStats();
            renderTokens();
            showToast('Using demo data. Scanning will resume shortly.', 'danger');
        }

        console.log('‚úÖ Meme Meter loaded - All Solana Tokens Edition!');
    </script>
</body>
</html>
